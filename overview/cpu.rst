.. _cpu:

========================
Using a Classical Solver
========================

You might use a classical solver while developing your code or on a small version of
your problem to verify your code. 
To solve a problem classically on your local machine, you configure a classical solver,
either one of those included in the Ocean tools or your own.

------------------------------
Example: Solving Ising Model
------------------------------

Among several samplers provided in the :std:doc:`dimod <dimod:index>`
tool for testing your code locally, is the :code:`ExactSolver()` that calculates the energy of all 
possible samples for a given problem. This example solves the following two-variable Ising model

.. math::

    -0.5a-b-ab

    a,b = -1,1

classically on your local machine.

.. code-block:: python

   >>> import dimod
   >>> solver = dimod.ExactSolver()
   >>> h = {'a': -0.5, 'b': 1.0}
   >>> J = {('a', 'b'): -1}
   >>> response = solver.sample_ising(h,J,num_reads=2)
   >>> response.data_vectors['energy']
   array([-1.5, -0.5, -0.5,  2.5])

This example solves the previous problem using the :std:doc:`dwave_neal <neal:index>`
simulated annealing sampler.
The two samples requested and generated by this classical solver on your local machine may
vary by execution.

.. code-block:: python

   >>> import neal
   >>> solver = neal.SimulatedAnnealingSampler()
   >>> h = {'a': -0.5, 'b': 1.0}
   >>> J = {('a', 'b'): -1}
   >>> response = solver.sample_ising(h,J,num_reads=2)
   >>> response.data_vectors['energy']
   array([-1.5, -1.5])


------------------------------
Example: Solving QUBO Model
------------------------------

The problem presented above can be translated into the following QUBO problem

.. math::

    r + 4s - 4rs - 1.5 

    r,s = 0,1

via the change of variables :math:`a = 2r-1` and :math:`b = 2s-1`.

The following code solves this two-variable QUBO problem classically on your local machine using the :code:`ExactSolver()`.

.. code-block:: python

   >>> import dimod
   >>> solver = dimod.ExactSolver()
   >>> Q = {('a','a'): 1.0, ('b','b'): 4.0 , ('a', 'b'): -4.0}
   >>> c = -1.5
   >>> response = solver.sample_qubo(Q)
   >>> response.data_vectors['energy'] + c
   array([-1.5, -0.5, -0.5,  2.5])


This QUBO problem can be addressed with :std:doc:`dwave_neal <neal:index>`
simulated annealing sampler on your local machine.

.. code-block:: python

   >>> import neal
   >>> solver = neal.SimulatedAnnealingSampler()
   >>> Q = {('a','a'): 1.0, ('b','b'): 4.0 , ('a', 'b'): -4.0}
   >>> c = -1.5
   >>> response = solver.sample_qubo(Q,num_reads=2)
   >>> response.data_vectors['energy'] + c
   array([-1.5, -1.5])

